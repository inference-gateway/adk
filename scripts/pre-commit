#!/bin/bash

# A2A ADK Pre-commit Hook
set -e

echo "ğŸ” Running pre-commit checks..."

# Check if there are any Go files being committed
if git diff --cached --name-only | grep -q '\.go$'; then
    echo "ğŸ“ Formatting Go code..."
    task format
    
    echo "ğŸ§¹ Tidying Go modules..."
    task tidy
    
    echo "ğŸ” Running linter..."
    task lint
    
    echo "ğŸ§ª Running tests..."
    task test
    
    git add $(git diff --cached --name-only | grep '\.go$' | tr '\n' ' ')
fi

echo "âœ… All pre-commit checks passed!"
